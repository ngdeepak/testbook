
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chapter 8 : Array Columns &#8212; Spark Data Frame Programming for Modern Data Engineering</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://github.com/ngdeepak/testbook/chapters/chapter8-array-column.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 9 : Map Column" href="chapter9-map-column.html" />
    <link rel="prev" title="Chapter 7 : Date Columns" href="chapter7-date-column.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://github.com/ngdeepak/testbook/chapters/chapter8-array-column.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Chapter 8 : Array Columns" />
<meta property="og:description" content="Chapter 8 : Array Columns  Chapter Learning Objectives  Various data operations on columns containing date strings, date and timestamps.  Chapter Outline  1. Ho" />
<meta property="og:image"       content="https://github.com/ngdeepak/testbook/_static/sparklogo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/sparklogo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Spark Data Frame Programming for Modern Data Engineering</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Author.html">
   Jupiter Book
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter1-spark-basics.html">
   Chapter 1: Spark Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2-dataframe.html">
   Chapter 2 : DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter3-data-sources.html">
   Chapter 3 : Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter4-data-types-schema.html">
   Chapter 4 : Data Types &amp; Schema
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter5-string-column.html">
   Chapter 5 : String Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter6-number-column.html">
   Chapter 6 : Number Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter7-date-column.html">
   Chapter 7 : Date Columns
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 8 : Array Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter9-map-column.html">
   Chapter 9 : Map Column
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter10-struct-column.html">
   Chapter 10 : Struct Column
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter11-json-string-column.html">
   Chapter 11 : JSON Column
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter12-null-nan-column.html">
   Chapter 12 : Null &amp; NaN Column
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter13-user-defined-function.html">
   Chapter 13 : User Defined Functions(UDFs)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter14-pandas-with-arrow.html">
   Chapter 14 : Pandas User Defined Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter15-aggregate-operations.html">
   Chapter 15 : Aggregate Operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter16-join-operations.html">
   Chapter 16 : Join operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter17-window-operations.html">
   Chapter 17 : Window operations
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapters/chapter8-array-column.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ngdeepak/testbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ngdeepak/testbook/issues/new?title=Issue%20on%20page%20%2Fchapters/chapter8-array-column.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/ngdeepak/testbook/edit/master/chapters/chapter8-array-column.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ngdeepak/testbook/master?urlpath=tree/chapters/chapter8-array-column.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-learning-objectives">
   Chapter Learning Objectives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-outline">
   Chapter Outline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-outline-gallery">
   Chapter Outline - Gallery
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-how-to-create-a-array-column-from-multiple-columns">
   1a. How to create a array column from multiple columns?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-how-to-remove-duplicate-values-from-an-array-column">
   1b. How to remove duplicate values from an array column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#c-how-to-check-if-a-value-is-in-an-array-column">
   1c. How to check if a value is in an array column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-how-to-find-the-list-of-elements-in-column-a-but-not-in-column-b-without-duplicates">
   1d. How to find the list of elements in column A, but not in column B without duplicates?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#e-how-to-sort-the-column-array-in-ascending-order">
   1e.How to sort the column array in ascending order?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#f-how-to-create-an-array-from-a-column-value-repeated-many-times">
   1f. How to create an array from a  column value  repeated  many times?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#g-how-to-remove-all-elements-equal-to-an-element-from-the-given-array-in-a-column">
   1g. How to remove all elements equal to an element from the given array in a column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#h-how-to-locate-the-position-of-first-occurrence-of-the-given-value-in-the-given-array-in-a-column">
   1h . How to locate the position of first occurrence of the given value in the given array in a column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-how-to-find-the-minimum-value-of-an-array-in-a-column">
   1i. How to find the minimum value of an array in a column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#j-how-to-find-the-maximum-value-of-an-array-in-a-column">
   1j. How to find the maximum value of an array in a column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#k-how-to-convert-a-column-of-nested-arrays-into-a-map-column">
   1k. How to convert a column of nested arrays into a map column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#l-how-to-sort-an-array-in-a-column-in-ascending-or-descending-order">
   1l. How to sort an array in a column in ascending or descending order?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#m-how-to-slice-an-array-in-a-column">
   1m. How to slice an array in a column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#n-how-to-shuffle-a-column-containing-an-array">
   1n. How to shuffle a column containing an array?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#o-how-to-create-a-array-column-containing-elements-with-sequence-start-stop-step">
   1o. How to create a  array column  containing elements with sequence(start, stop, step)?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#p-how-to-reverse-the-order-not-reverse-sort-of-an-array-in-a-column">
   1p. How to reverse the order(not reverse sort) of an array in a column ?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q-how-to-combine-two-array-columns-into-a-map-column">
   1q. How to combine two array columns into a map column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#r-how-to-concatenate-the-elements-of-an-array-in-a-column">
   1r. How to concatenate the elements of an array in a column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-how-to-find-overlap-between-2-array-columns">
   1s. How to find overlap between 2 array columns?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#t-how-to-flatten-a-column-containing-nested-arrays">
   1t. How to flatten a column containing nested arrays?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#u-how-to-concatenate-the-elements-of-an-array-in-a-column">
   1u. How to concatenate the elements of an array in a column?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#v-how-to-zip-2-array-columns">
   1v. How to zip 2 array columns ?
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="figure align-center" id="banner">
<img alt="../_images/banner.png" src="../_images/banner.png" />
</div>
<div class="section" id="chapter-8-array-columns">
<h1>Chapter 8 : Array Columns<a class="headerlink" href="#chapter-8-array-columns" title="Permalink to this headline">¶</a></h1>
<div class="section" id="chapter-learning-objectives">
<h2>Chapter Learning Objectives<a class="headerlink" href="#chapter-learning-objectives" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Various data operations on columns containing date strings, date and timestamps.</p></li>
</ul>
</div>
<div class="section" id="chapter-outline">
<h2>Chapter Outline<a class="headerlink" href="#chapter-outline" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#1">1. How to deal with Array columns?</a></p>
<ul>
<li><p><a class="reference external" href="#2">1a. How to create a array column from multiple columns?</a></p></li>
<li><p><a class="reference external" href="#3">1b. How to remove duplicate values from an array column?</a></p></li>
<li><p><a class="reference external" href="#4">1c. How to check if a value is in an array column?</a></p></li>
<li><p><a class="reference external" href="#5">1d. How to find the list of elements in column A, but not in column B without duplicates?</a></p></li>
<li><p><a class="reference external" href="#6">1e. How to sort the column array in ascending order?</a></p></li>
<li><p><a class="reference external" href="#7">1f. How to create an array from a  column value  repeated  many times?</a></p></li>
<li><p><a class="reference external" href="#8">1g. How to remove all elements equal to an element from the given array in a column?</a></p></li>
<li><p><a class="reference external" href="#9">1h. How to locate the position of first occurrence of the given value in the given array in a column?</a></p></li>
<li><p><a class="reference external" href="#10">1i. How to find the minimum value of an array in a column?</a></p></li>
<li><p><a class="reference external" href="#11">1j. How to find the maximum value of an array in a column?</a></p></li>
<li><p><a class="reference external" href="#12">1k. How to convert a column of nested arrays into a map column?</a></p></li>
<li><p><a class="reference external" href="#13">1l. How to sort an array in a column in ascending or descending order?</a></p></li>
<li><p><a class="reference external" href="#14">1m. How to slice an array in a column?</a></p></li>
<li><p><a class="reference external" href="#15">1n. How to shuffle a column containing an array?</a></p></li>
<li><p><a class="reference external" href="#16">1o. How to create a  array column  containing elements with sequence(start, stop, step)?</a></p></li>
<li><p><a class="reference external" href="#17">1p. How to reverse the order(not reverse sort) of an array in a column ?</a></p></li>
<li><p><a class="reference external" href="#18">1q. How to combine two array columns into a map column?</a></p></li>
<li><p><a class="reference external" href="#19">1r. How to convert unix timestamp to a string timestamp?</a></p></li>
<li><p><a class="reference external" href="#20">1s. How to find overlap between 2 array columns?</a></p></li>
<li><p><a class="reference external" href="#21">1t. How to flatten a column containing nested arrays?</a></p></li>
<li><p><a class="reference external" href="#22">1u. How to concatenate the elements of an array in a column?</a></p></li>
<li><p><a class="reference external" href="#23">1v. How to zip 2 array columns ?</a></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyspark</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span> \
    <span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;Python Spark SQL basic example&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.some.config.option&quot;</span><span class="p">,</span> <span class="s2">&quot;some-value&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display_html</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">display_side_by_side</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">html_str</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">html_str</span><span class="o">+=</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">html_str</span><span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\xa0\xa0\xa0</span><span class="s2">&quot;</span><span class="o">*</span><span class="mi">10</span>
    <span class="n">display_html</span><span class="p">(</span><span class="n">html_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,</span><span class="s1">&#39;table style=&quot;display:inline&quot;&#39;</span><span class="p">),</span><span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">space</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\xa0</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">panel</span> <span class="k">as</span> <span class="nn">pn</span>

<span class="n">css</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">div.special_table + table, th, td {</span>
<span class="s2">  border: 3px solid orange;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">pn</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">raw_css</span><span class="o">=</span><span class="p">[</span><span class="n">css</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    var skip = [];
    if (window.requirejs) {
      require([], function() {
      })
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) >= 0) { on_load(); continue; }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
	if (!js_urls.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-2.2.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.2.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.2.3.min.js", "https://unpkg.com/@holoviz/panel@^0.10.3/dist/panel.min.js"];
  var css_urls = ["https://unpkg.com/@holoviz/panel@0.10.3/dist/css/alerts.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/card.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/widgets.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/markdown.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/json.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/dataframe.css"];

  var inline_js = [
    function(Bokeh) {
      inject_raw_css("\ndiv.special_table + table, th, td {\n  border: 3px solid orange;\n}\n");
    },
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script></div>
</div>
<p><a id='1'></a></p>
</div>
<div class="section" id="chapter-outline-gallery">
<h2>Chapter Outline - Gallery<a class="headerlink" href="#chapter-outline-gallery" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="#2"><img alt="alt" src="../_images/11.png" /></a></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>click on</p></th>
<th class="text-align:left head"><p>any image</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#3"><img alt="alt" src="../_images/213.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#4"><img alt="alt" src="../_images/312.png" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><a class="reference external" href="#5"><img alt="alt" src="../_images/412.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#6"><img alt="alt" src="../_images/510.png" /></a></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#7"><img alt="alt" src="../_images/69.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#8"><img alt="alt" src="../_images/76.png" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><a class="reference external" href="#9"><img alt="alt" src="../_images/85.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#10"><img alt="alt" src="../_images/94.png" /></a></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#11"><img alt="alt" src="../_images/103.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#12"><img alt="alt" src="../_images/116.png" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><a class="reference external" href="#13"><img alt="alt" src="../_images/123.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#14"><img alt="alt" src="../_images/133.png" /></a></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#15"><img alt="alt" src="../_images/141.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#16"><img alt="alt" src="../_images/151.png" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><a class="reference external" href="#17"><img alt="alt" src="../_images/161.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#18"><img alt="alt" src="../_images/171.png" /></a></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#19"><img alt="alt" src="../_images/181.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#20"><img alt="alt" src="../_images/191.png" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><a class="reference external" href="#21"><img alt="alt" src="../_images/20.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#22"><img alt="alt" src="../_images/214.png" /></a></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#23"><img alt="alt" src="../_images/221.png" /></a></p></td>
<td class="text-align:left"><p></p></td>
</tr>
</tbody>
</table>
<p><a id='2'></a></p>
<p><a id='2'></a></p>
</div>
<div class="section" id="a-how-to-create-a-array-column-from-multiple-columns">
<h2>1a. How to create a array column from multiple columns?<a class="headerlink" href="#a-how-to-create-a-array-column-from-multiple-columns" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/11.png" src="../_images/11.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array(*cols)</b></p>
<p>Creates a new array column.</p>
<p><b>Parameters</b></p>
<p>cols – list of column names (string) or list of Column expressions that have the same data type.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with multiple columns</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mul</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;Seattle&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="s1">&#39;1960-01-01&#39;</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;Tony&#39;</span><span class="p">,</span> <span class="s1">&#39;Cupertino&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="s1">&#39;1990-01-01&#39;</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;Mike&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">,</span> <span class="s1">&#39;1980-01-01&#39;</span><span class="p">)],[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;smoker&#39;</span><span class="p">,</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;birthdate&#39;</span><span class="p">])</span>
<span class="n">df_mul</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----+---------+---+------+------+----------+
|name|     city|age|smoker|height| birthdate|
+----+---------+---+------+------+----------+
|John|  Seattle| 60|  true|   1.7|1960-01-01|
|Tony|Cupertino| 30| false|   1.8|1990-01-01|
|Mike| New York| 40|  true|  1.65|1980-01-01|
+----+---------+---+------+------+----------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array</span>
<span class="n">df_array</span> <span class="o">=</span> <span class="n">df_mul</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">df_mul</span><span class="o">.</span><span class="n">age</span><span class="p">,</span><span class="n">df_mul</span><span class="o">.</span><span class="n">height</span><span class="p">,</span><span class="n">df_mul</span><span class="o">.</span><span class="n">city</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;array_column&quot;</span><span class="p">))</span>
<span class="n">df_array</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+--------------------+
|        array_column|
+--------------------+
|  [60, 1.7, Seattle]|
|[30, 1.8, Cupertino]|
|[40, 1.65, New York]|
+--------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_mul</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_array</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>city</th>
      <th>age</th>
      <th>smoker</th>
      <th>height</th>
      <th>birthdate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>John</td>
      <td>Seattle</td>
      <td>60</td>
      <td>True</td>
      <td>1.70</td>
      <td>1960-01-01</td>
    </tr>
    <tr>
      <td>Tony</td>
      <td>Cupertino</td>
      <td>30</td>
      <td>False</td>
      <td>1.80</td>
      <td>1990-01-01</td>
    </tr>
    <tr>
      <td>Mike</td>
      <td>New York</td>
      <td>40</td>
      <td>True</td>
      <td>1.65</td>
      <td>1980-01-01</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>array_column</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[60, 1.7, Seattle]</td>
    </tr>
    <tr>
      <td>[30, 1.8, Cupertino]</td>
    </tr>
    <tr>
      <td>[40, 1.65, New York]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='3'></a></p>
</div>
<div class="section" id="b-how-to-remove-duplicate-values-from-an-array-column">
<h2>1b. How to remove duplicate values from an array column?<a class="headerlink" href="#b-how-to-remove-duplicate-values-from-an-array-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/213.png" src="../_images/213.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>ppyspark.sql.functions.array_distinct(col)</b></p>
<p>removes duplicate values from the array</p>
<p><b>Parameters</b>:</p>
<p>col – name of column or expression
‘’’</p>
</div>
<p><b>Input:  Spark data frame with a array column with duplicates</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_array</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df_array</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------------+
|           data|
+---------------+
|[1, 2, 3, 2, 4]|
|[4, 5, 5, 4, 6]|
+---------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a array column with no duplicates</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_distinct</span>
<span class="n">df_array_no</span> <span class="o">=</span> <span class="n">df_array</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_distinct</span><span class="p">(</span><span class="n">df_array</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;array_no_dup&quot;</span><span class="p">))</span>
<span class="n">df_array_no</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------------+
|array_no_dup|
+------------+
|[1, 2, 3, 4]|
|   [4, 5, 6]|
+------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_array</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_array_no</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 2, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 5, 4, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>array_no_dup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='4'></a></p>
</div>
<div class="section" id="c-how-to-check-if-a-value-is-in-an-array-column">
<h2>1c. How to check if a value is in an array column?<a class="headerlink" href="#c-how-to-check-if-a-value-is-in-an-array-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/312.png" src="../_images/312.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_contains(col, value)</b></p>
<p>returns null if the array is null, true if the array contains the given value, and false otherwise.</p>
<p><b>Parameters</b>:</p>
<ul class="simple">
<li><p>col – name of column containing array</p></li>
<li><p>value – value or column to check for in array</p></li>
</ul>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with a array column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],),</span> <span class="p">([],),([</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------+
|     data|
+---------+
|[1, 2, 3]|
|       []|
|      [,]|
+---------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a column to indicate if a value exists </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_contains</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_contains</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;if_1_exists&quot;</span><span class="p">))</span>
<span class="n">df2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------+
|if_1_exists|
+-----------+
|       true|
|      false|
|       null|
+-----------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df2</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input                      output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3]</td>
    </tr>
    <tr>
      <td>[]</td>
    </tr>
    <tr>
      <td>[None, None]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>if_1_exists</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>True</td>
    </tr>
    <tr>
      <td>False</td>
    </tr>
    <tr>
      <td>None</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='5'></a></p>
</div>
<div class="section" id="d-how-to-find-the-list-of-elements-in-column-a-but-not-in-column-b-without-duplicates">
<h2>1d. How to find the list of elements in column A, but not in column B without duplicates?<a class="headerlink" href="#d-how-to-find-the-list-of-elements-in-column-a-but-not-in-column-b-without-duplicates" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/412.png" src="../_images/412.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_except(col1, col2)</b></p>
<p>returns an array of the elements in col1 but not in col2, without duplicates.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col1 – name of column containing array</p></li>
<li><p>col2 – name of column containing array
‘’’</p></li>
</ul>
</div>
<p><b>Input:  Spark data frame with 2 array columns </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df3</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------------+----------------+
|              A|               B|
+---------------+----------------+
|[1, 2, 3, 4, 5]|[6, 7, 8, 9, 10]|
|[4, 5, 5, 4, 6]| [6, 2, 3, 2, 4]|
+---------------+----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a result array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_except</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_except</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">df3</span><span class="o">.</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;in_A_not_in_B&quot;</span><span class="p">))</span>
<span class="n">df4</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------------+
|  in_A_not_in_B|
+---------------+
|[1, 2, 3, 4, 5]|
|            [5]|
+---------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df4</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 4, 5]</td>
      <td>[6, 7, 8, 9, 10]</td>
    </tr>
    <tr>
      <td>[4, 5, 5, 4, 6]</td>
      <td>[6, 2, 3, 2, 4]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>in_A_not_in_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 4, 5]</td>
    </tr>
    <tr>
      <td>[5]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='6'></a></p>
</div>
<div class="section" id="e-how-to-sort-the-column-array-in-ascending-order">
<h2>1e.How to sort the column array in ascending order?<a class="headerlink" href="#e-how-to-sort-the-column-array-in-ascending-order" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/510.png" src="../_images/510.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_sort(col)</b></p>
<p>sorts the input array in ascending order. The elements of the input array must be orderable. Null elements will be placed at the end of the returned array.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col – name of column or expression
‘’’</p></li>
</ul>
</div>
<p><b>Input:  Spark data frame with an array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_arr</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],),([</span><span class="mi">1</span><span class="p">],),([],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df_arr</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+
|               data|
+-------------------+
|[2, 1,, 3, 8, 3, 5]|
|                [1]|
|                 []|
+-------------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a sorted array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_sort</span>
<span class="n">df_sort</span> <span class="o">=</span><span class="n">df_arr</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_sort</span><span class="p">(</span><span class="n">df_arr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;sort&#39;</span><span class="p">))</span>
<span class="n">df_sort</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+
|               sort|
+-------------------+
|[1, 2, 3, 3, 5, 8,]|
|                [1]|
|                 []|
+-------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_arr</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_sort</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[2, 1, None, 3, 8, 3, 5]</td>
    </tr>
    <tr>
      <td>[1]</td>
    </tr>
    <tr>
      <td>[]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>sort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 3, 5, 8, None]</td>
    </tr>
    <tr>
      <td>[1]</td>
    </tr>
    <tr>
      <td>[]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='7'></a></p>
</div>
<div class="section" id="f-how-to-create-an-array-from-a-column-value-repeated-many-times">
<h2>1f. How to create an array from a  column value  repeated  many times?<a class="headerlink" href="#f-how-to-create-an-array-from-a-column-value-repeated-many-times" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/69.png" src="../_images/69.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_repeat(col, count)</b></p>
<p>Collection function: creates an array containing a column repeated count times.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with a column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_val</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="mi">5</span><span class="p">,)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df_val</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----+
|data|
+----+
|   5|
+----+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a column of array of repeated values</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_repeat</span>
<span class="n">df_repeat</span> <span class="o">=</span> <span class="n">df_val</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_repeat</span><span class="p">(</span><span class="n">df_val</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;repeat&#39;</span><span class="p">))</span>
<span class="n">df_repeat</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------+
|   repeat|
+---------+
|[5, 5, 5]|
+---------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_val</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_repeat</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>repeat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[5, 5, 5]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='8'></a></p>
</div>
<div class="section" id="g-how-to-remove-all-elements-equal-to-an-element-from-the-given-array-in-a-column">
<h2>1g. How to remove all elements equal to an element from the given array in a column?<a class="headerlink" href="#g-how-to-remove-all-elements-equal-to-an-element-from-the-given-array-in-a-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/76.png" src="../_images/76.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_remove(col, element)</b></p>
<p>Remove all elements that equal to element from the given array.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col – name of column containing array</p></li>
<li><p>element – element to be removed from the array</p></li>
</ul>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with an array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_arr2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df_arr2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             data|
+-----------------+
|  [1, 2, 3, 8, 4]|
|[4, 5, 32, 32, 6]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with an array column with an element removed</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_remove</span>
<span class="n">df_arr3</span> <span class="o">=</span> <span class="n">df_arr2</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_remove</span><span class="p">(</span><span class="n">df_arr2</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;array_remove_4&quot;</span><span class="p">))</span>
<span class="n">df_arr3</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+--------------+
|array_remove_4|
+--------------+
|  [1, 2, 3, 8]|
|[5, 32, 32, 6]|
+--------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_arr2</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_arr3</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>array_remove_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8]</td>
    </tr>
    <tr>
      <td>[5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='9'></a></p>
<p><a id='9'></a></p>
</div>
<div class="section" id="h-how-to-locate-the-position-of-first-occurrence-of-the-given-value-in-the-given-array-in-a-column">
<h2>1h . How to locate the position of first occurrence of the given value in the given array in a column?<a class="headerlink" href="#h-how-to-locate-the-position-of-first-occurrence-of-the-given-value-in-the-given-array-in-a-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/85.png" src="../_images/85.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_position(col, value)</b></p>
<p>Collection function: Locates the position of the first occurrence of the given value in the given array. Returns null if either of the arguments are null.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with an array column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pos1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df_pos1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             data|
+-----------------+
|  [1, 2, 3, 8, 4]|
|[4, 5, 32, 32, 6]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with column giving the position of the element </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_position</span>
<span class="n">df_pos2</span> <span class="o">=</span> <span class="n">df_pos1</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_position</span><span class="p">(</span><span class="n">df_pos1</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;array_position_4&quot;</span><span class="p">))</span>
<span class="n">df_pos2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------------+
|array_position_4|
+----------------+
|               5|
|               1|
+----------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_pos1</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_pos2</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>array_position_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5</td>
    </tr>
    <tr>
      <td>1</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='10'></a></p>
</div>
<div class="section" id="i-how-to-find-the-minimum-value-of-an-array-in-a-column">
<h2>1i. How to find the minimum value of an array in a column?<a class="headerlink" href="#i-how-to-find-the-minimum-value-of-an-array-in-a-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/94.png" src="../_images/94.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_min(col)</b></p>
<p>returns the minimum value of the array.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col – name of column or expression
‘’’</p></li>
</ul>
</div>
<p><b>Input:  Spark data frame with an array columns</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_arr</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df_arr</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             data|
+-----------------+
|  [1, 2, 3, 8, 4]|
|[4, 5, 32, 32, 6]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_min</span>
<span class="n">df_min</span> <span class="o">=</span> <span class="n">df_arr</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_min</span><span class="p">(</span><span class="n">df_arr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;array_min&quot;</span><span class="p">))</span>
<span class="n">df_min</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------+
|array_min|
+---------+
|        1|
|        4|
+---------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_arr</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_min</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>array_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='11'></a></p>
</div>
<div class="section" id="j-how-to-find-the-maximum-value-of-an-array-in-a-column">
<h2>1j. How to find the maximum value of an array in a column?<a class="headerlink" href="#j-how-to-find-the-maximum-value-of-an-array-in-a-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/103.png" src="../_images/103.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_max(col)</b></p>
<p>returns the maximum value of the array.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col – name of column or expression
‘’’</p></li>
</ul>
</div>
<p><b>Input:  Spark data frame with an array column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             data|
+-----------------+
|  [1, 2, 3, 8, 4]|
|[4, 5, 32, 32, 6]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_max</span>
<span class="n">df_max</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;array_max&quot;</span><span class="p">))</span>
<span class="n">df_max</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------+
|array_max|
+---------+
|        8|
|       32|
+---------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_max</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input                      output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>array_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>8</td>
    </tr>
    <tr>
      <td>32</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='12'></a></p>
</div>
<div class="section" id="k-how-to-convert-a-column-of-nested-arrays-into-a-map-column">
<h2>1k. How to convert a column of nested arrays into a map column?<a class="headerlink" href="#k-how-to-convert-a-column-of-nested-arrays-into-a-map-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/116.png" src="../_images/116.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.map_from_arrays(col1, col2)</b></p>
<p>Creates a new map from two arrays.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col1 – name of column containing a set of keys. All elements should not be null</p></li>
<li><p>col2 – name of column containing a set of values</p></li>
</ul>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with a map column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT array(struct(1, &#39;a&#39;), struct(2, &#39;b&#39;)) as data&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------------+
|            data|
+----------------+
|[[1, a], [2, b]]|
+----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a date column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">map_from_entries</span>
<span class="n">df_map</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">map_from_entries</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;map&quot;</span><span class="p">))</span>
<span class="n">df_map</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------------+
|             map|
+----------------+
|[1 -&gt; a, 2 -&gt; b]|
+----------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_map</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[(1, a), (2, b)]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>map</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{1: 'a', 2: 'b'}</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='13'></a></p>
</div>
<div class="section" id="l-how-to-sort-an-array-in-a-column-in-ascending-or-descending-order">
<h2>1l. How to sort an array in a column in ascending or descending order?<a class="headerlink" href="#l-how-to-sort-an-array-in-a-column-in-ascending-or-descending-order" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/123.png" src="../_images/123.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.sort_array(col, asc=True)</b></p>
<p>sorts the input array in ascending or descending order according to the natural ordering of the array elements. Null elements will be placed at the beginning of the returned array in ascending order or at the end of the returned array in descending order.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col – name of column or expression
‘’’</p></li>
</ul>
</div>
<p><b>Input:  Spark data frame with an array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             data|
+-----------------+
|  [1, 2, 3, 8, 4]|
|[4, 5, 32, 32, 6]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a sorted array column  </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">sort_array</span>
<span class="n">df_asc</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">sort_array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">asc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;asc&#39;</span><span class="p">))</span>
<span class="n">df_asc</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|              asc|
+-----------------+
|  [1, 2, 3, 4, 8]|
|[4, 5, 6, 32, 32]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">sort_array</span>
<span class="n">df_desc</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">sort_array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">asc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">))</span>
<span class="n">df_desc</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             desc|
+-----------------+
|  [8, 4, 3, 2, 1]|
|[32, 32, 6, 5, 4]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_asc</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span> <span class="n">df_desc</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>asc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 4, 8]</td>
    </tr>
    <tr>
      <td>[4, 5, 6, 32, 32]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>desc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[8, 4, 3, 2, 1]</td>
    </tr>
    <tr>
      <td>[32, 32, 6, 5, 4]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='15'></a></p>
<p><a id='14'></a></p>
</div>
<div class="section" id="m-how-to-slice-an-array-in-a-column">
<h2>1m. How to slice an array in a column?<a class="headerlink" href="#m-how-to-slice-an-array-in-a-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/133.png" src="../_images/133.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.map_from_arrays(col1, col2)</b></p>
<p>Creates a new map from two arrays.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col1 – name of column containing a set of keys. All elements should not be null</p></li>
<li><p>col2 – name of column containing a set of values</p></li>
</ul>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with an array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             data|
+-----------------+
|  [1, 2, 3, 8, 4]|
|[4, 5, 32, 32, 6]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with an array column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="nb">slice</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;slice&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------+
|      slice|
+-----------+
|  [2, 3, 8]|
|[5, 32, 32]|
+-----------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_map</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>map</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{1: 'a', 2: 'b'}</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='15'></a></p>
</div>
<div class="section" id="n-how-to-shuffle-a-column-containing-an-array">
<h2>1n. How to shuffle a column containing an array?<a class="headerlink" href="#n-how-to-shuffle-a-column-containing-an-array" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/141.png" src="../_images/141.png" />
</div>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.shuffle(col)</b></p>
<p>Generates a random permutation of the given array.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with an array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             data|
+-----------------+
|  [1, 2, 3, 8, 4]|
|[4, 5, 32, 32, 6]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with shuffled array column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="n">df_shu</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">shuffle</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;shuffle&#39;</span><span class="p">))</span>
<span class="n">df_shu</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|          shuffle|
+-----------------+
|  [2, 4, 3, 8, 1]|
|[32, 5, 6, 32, 4]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_shu</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>shuffle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[2, 4, 3, 8, 1]</td>
    </tr>
    <tr>
      <td>[32, 5, 6, 32, 4]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='16'></a></p>
</div>
<div class="section" id="o-how-to-create-a-array-column-containing-elements-with-sequence-start-stop-step">
<h2>1o. How to create a  array column  containing elements with sequence(start, stop, step)?<a class="headerlink" href="#o-how-to-create-a-array-column-containing-elements-with-sequence-start-stop-step" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/151.png" src="../_images/151.png" />
</div>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.sequence(start, stop, step=None)</b></p>
<p>Generate a sequence of integers from start to stop, incrementing by step. If step is not set, incrementing by 1 if start is less than or equal to stop, otherwise -1.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---+---+
|  A|  B|
+---+---+
| -2|  2|
+---+---+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with an array sequence</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">sequence</span>
<span class="n">df_seq</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">sequence</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;seq&#39;</span><span class="p">))</span>
<span class="n">df_seq</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|              seq|
+-----------------+
|[-2, -1, 0, 1, 2]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_seq</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-2</td>
      <td>2</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[-2, -1, 0, 1, 2]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='17'></a></p>
</div>
<div class="section" id="p-how-to-reverse-the-order-not-reverse-sort-of-an-array-in-a-column">
<h2>1p. How to reverse the order(not reverse sort) of an array in a column ?<a class="headerlink" href="#p-how-to-reverse-the-order-not-reverse-sort-of-an-array-in-a-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/161.png" src="../_images/161.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.map_from_arrays(col1, col2)</b></p>
<p>Creates a new map from two arrays.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col1 – name of column containing a set of keys. All elements should not be null</p></li>
<li><p>col2 – name of column containing a set of values</p></li>
</ul>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with an array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_arr</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df_arr</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|             data|
+-----------------+
|  [1, 2, 3, 8, 4]|
|[4, 5, 32, 32, 6]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a reverse ordered array column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="n">df_rev</span> <span class="o">=</span> <span class="n">df_arr</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="n">df_arr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;reverse_order&#39;</span><span class="p">))</span>
<span class="n">df_rev</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------+
|reverse_order    |
+-----------------+
|[4, 8, 3, 2, 1]  |
|[6, 32, 32, 5, 4]|
+-----------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_arr</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_rev</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>reverse_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[4, 8, 3, 2, 1]</td>
    </tr>
    <tr>
      <td>[6, 32, 32, 5, 4]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='18'></a></p>
</div>
<div class="section" id="q-how-to-combine-two-array-columns-into-a-map-column">
<h2>1q. How to combine two array columns into a map column?<a class="headerlink" href="#q-how-to-combine-two-array-columns-into-a-map-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/171.png" src="../_images/171.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.map_from_arrays(col1, col2)</b></p>
<p>Creates a new map from two arrays.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>col1 – name of column containing a set of keys. All elements should not be null</p></li>
<li><p>col2 – name of column containing a set of values</p></li>
</ul>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with 2 array columns </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_arrm</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">])],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df_arrm</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------------+----------------+
|              A|               B|
+---------------+----------------+
|[1, 2, 3, 4, 5]|[6, 7, 8, 9, 10]|
|[4, 5, 6, 7, 8]| [6, 2, 3, 9, 4]|
+---------------+----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a map column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">map_from_arrays</span>
<span class="n">df_map</span> <span class="o">=</span> <span class="n">df_arrm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">map_from_arrays</span><span class="p">(</span><span class="n">df_arrm</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">df_arrm</span><span class="o">.</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">))</span>
<span class="n">df_map</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------------------------+
|map                                      |
+-----------------------------------------+
|[1 -&gt; 6, 2 -&gt; 7, 3 -&gt; 8, 4 -&gt; 9, 5 -&gt; 10]|
|[4 -&gt; 6, 5 -&gt; 2, 6 -&gt; 3, 7 -&gt; 9, 8 -&gt; 4] |
+-----------------------------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_arrm</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_map</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 4, 5]</td>
      <td>[6, 7, 8, 9, 10]</td>
    </tr>
    <tr>
      <td>[4, 5, 6, 7, 8]</td>
      <td>[6, 2, 3, 9, 4]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>map</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{1: 6, 2: 7, 3: 8, 4: 9, 5: 10}</td>
    </tr>
    <tr>
      <td>{8: 4, 4: 6, 5: 2, 6: 3, 7: 9}</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='19'></a></p>
</div>
<div class="section" id="r-how-to-concatenate-the-elements-of-an-array-in-a-column">
<h2>1r. How to concatenate the elements of an array in a column?<a class="headerlink" href="#r-how-to-concatenate-the-elements-of-an-array-in-a-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/181.png" src="../_images/181.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.concat(*cols)</b></p>
<p>Concatenates multiple input columns together into a single column. The function works with strings, binary and compatible array columns.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with a map column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_arr1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">])],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df_arr1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------------+----------------+
|              A|               B|
+---------------+----------------+
|[1, 2, 3, 4, 5]|[6, 7, 8, 9, 10]|
|[4, 5, 6, 7, 8]| [6, 2, 3, 9, 4]|
+---------------+----------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a date column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">concat</span>
<span class="n">df_con</span> <span class="o">=</span> <span class="n">df_arr1</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">df_arr1</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">df_arr1</span><span class="o">.</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;concatenate&quot;</span><span class="p">))</span>
<span class="n">df_con</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------------------+
|concatenate                    |
+-------------------------------+
|[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]|
|[4, 5, 6, 7, 8, 6, 2, 3, 9, 4] |
+-------------------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_arr1</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_con</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 4, 5]</td>
      <td>[6, 7, 8, 9, 10]</td>
    </tr>
    <tr>
      <td>[4, 5, 6, 7, 8]</td>
      <td>[6, 2, 3, 9, 4]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>concatenate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</td>
    </tr>
    <tr>
      <td>[4, 5, 6, 7, 8, 6, 2, 3, 9, 4]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='20'></a></p>
</div>
<div class="section" id="s-how-to-find-overlap-between-2-array-columns">
<h2>1s. How to find overlap between 2 array columns?<a class="headerlink" href="#s-how-to-find-overlap-between-2-array-columns" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/191.png" src="../_images/191.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.arrays_overlap(a1, a2)</b></p>
<p>Collection function: returns true if the arrays contain any common non-null element; if not, returns null if both the arrays are non-empty and any of them contains a null element; returns false otherwise</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with array columns </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_over</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],),</span> <span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],),([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">],)</span> <span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df_over</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------+------+
|     A|     B|
+------+------+
|[a, b]|[b, c]|
|   [a]|[b, c]|
|  [a,]|  [b,]|
+------+------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">arrays_overlap</span>
<span class="n">df_overlap</span> <span class="o">=</span> <span class="n">df_over</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">arrays_overlap</span><span class="p">(</span><span class="n">df_over</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">df_over</span><span class="o">.</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;overlap&quot;</span><span class="p">))</span>
<span class="n">df_overlap</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------+
|overlap|
+-------+
|   true|
|  false|
|   null|
+-------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_over</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_overlap</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[a, b]</td>
      <td>[b, c]</td>
    </tr>
    <tr>
      <td>[a]</td>
      <td>[b, c]</td>
    </tr>
    <tr>
      <td>[a, None]</td>
      <td>[b, None]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>overlap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>True</td>
    </tr>
    <tr>
      <td>False</td>
    </tr>
    <tr>
      <td>None</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='21'></a></p>
</div>
<div class="section" id="t-how-to-flatten-a-column-containing-nested-arrays">
<h2>1t. How to flatten a column containing nested arrays?<a class="headerlink" href="#t-how-to-flatten-a-column-containing-nested-arrays" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/20.png" src="../_images/20.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.flatten(col)</b></p>
<p>creates a single array from an array of arrays. If a structure of nested arrays is deeper than two levels, only one level of nesting is removed.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with nested array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],),</span> <span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],)],</span> <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df4</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------------+
|data                         |
+-----------------------------+
|[[1, 2, 3, 8, 4], [6, 8, 10]]|
|[[4, 5, 32, 32, 6]]          |
+-----------------------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a flattended array column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">flatten</span>
<span class="n">df_flat</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">df4</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;flatten&#39;</span><span class="p">))</span>
<span class="n">df_flat</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------------+
|flatten                  |
+-------------------------+
|[1, 2, 3, 8, 4, 6, 8, 10]|
|[4, 5, 32, 32, 6]        |
+-------------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df4</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_flat</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[[1, 2, 3, 8, 4], [6, 8, 10]]</td>
    </tr>
    <tr>
      <td>[[4, 5, 32, 32, 6]]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>flatten</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 8, 4, 6, 8, 10]</td>
    </tr>
    <tr>
      <td>[4, 5, 32, 32, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='22'></a></p>
</div>
<div class="section" id="u-how-to-concatenate-the-elements-of-an-array-in-a-column">
<h2>1u. How to concatenate the elements of an array in a column?<a class="headerlink" href="#u-how-to-concatenate-the-elements-of-an-array-in-a-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/214.png" src="../_images/214.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.array_join(col, delimiter, null_replacement=None)</b></p>
<p>Concatenates the elements of column using the delimiter. Null values are replaced with null_replacement if set, otherwise they are ignored.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with an array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_a1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],),</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],)],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>
<span class="n">df_a1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------------+
|              A|
+---------------+
|[1, 2, 3, 4, 5]|
|  [4, 5,, 4, 6]|
+---------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a concatenated array element column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">array_join</span>
<span class="n">df_j1</span> <span class="o">=</span> <span class="n">df_a1</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_join</span><span class="p">(</span><span class="n">df_a1</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;array_join&quot;</span><span class="p">))</span>
<span class="n">df_j1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
|array_join|
+----------+
| 1,2,3,4,5|
|   4,5,4,6|
+----------+
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_j2</span> <span class="o">=</span> <span class="n">df_a1</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array_join</span><span class="p">(</span><span class="n">df_a1</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">null_replacement</span><span class="o">=</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;array_join&quot;</span><span class="p">))</span>
<span class="n">df_j2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
|array_join|
+----------+
| 1,2,3,4,5|
|4,5,NA,4,6|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_a1</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_j1</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span> <span class="n">df_j2</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3, 4, 5]</td>
    </tr>
    <tr>
      <td>[4, 5, None, 4, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>array_join</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1,2,3,4,5</td>
    </tr>
    <tr>
      <td>4,5,4,6</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>array_join</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1,2,3,4,5</td>
    </tr>
    <tr>
      <td>4,5,NA,4,6</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='23'></a></p>
</div>
<div class="section" id="v-how-to-zip-2-array-columns">
<h2>1v. How to zip 2 array columns ?<a class="headerlink" href="#v-how-to-zip-2-array-columns" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/221.png" src="../_images/221.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.arrays_zip(*cols)</b></p>
<p>Collection function: Returns a merged array of structs in which the N-th struct contains all N-th values of input arrays.</p>
<p>Parameters
cols – columns of arrays to be merged.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with an array column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfz</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">dfz</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---------+---------+
|        A|        B|
+---------+---------+
|[1, 2, 3]|[4, 5, 6]|
+---------+---------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a zipped array column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">arrays_zip</span>
<span class="n">df_zip</span> <span class="o">=</span> <span class="n">dfz</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">arrays_zip</span><span class="p">(</span><span class="n">dfz</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">dfz</span><span class="o">.</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;zipped&#39;</span><span class="p">))</span>
<span class="n">df_zip</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------------------------+
|zipped                  |
+------------------------+
|[[1, 4], [2, 5], [3, 6]]|
+------------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">dfz</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_zip</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[1, 2, 3]</td>
      <td>[4, 5, 6]</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>zipped</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[(1, 4), (2, 5), (3, 6)]</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ngdeepak/testbook",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="chapter7-date-column.html" title="previous page">Chapter 7 : Date Columns</a>
    <a class='right-next' id="next-link" href="chapter9-map-column.html" title="next page">Chapter 9 : Map Column</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Deepak Gowda<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>