
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chapter 7 : Date Columns &#8212; Spark Data Frame Programming for Modern Data Engineering</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://github.com/ngdeepak/testbook/chapters/chapter7-date-column.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 8 : Array Columns" href="chapter8-array-column.html" />
    <link rel="prev" title="Chapter 6 : Number Columns" href="chapter6-number-column.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://github.com/ngdeepak/testbook/chapters/chapter7-date-column.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Chapter 7 : Date Columns" />
<meta property="og:description" content="Chapter 7 : Date Columns  Chapter Learning Objectives  Various data operations on columns containing date strings, date and timestamps.  Chapter Outline  1. How" />
<meta property="og:image"       content="https://github.com/ngdeepak/testbook/_static/sparklogo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/sparklogo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Spark Data Frame Programming for Modern Data Engineering</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Author.html">
   Jupiter Book
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter1-spark-basics.html">
   Chapter 1: Spark Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2-dataframe.html">
   Chapter 2 : DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter3-data-sources.html">
   Chapter 3 : Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter4-data-types-schema.html">
   Chapter 4 : Data Types &amp; Schema
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter5-string-column.html">
   Chapter 5 : String Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter6-number-column.html">
   Chapter 6 : Number Columns
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 7 : Date Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter8-array-column.html">
   Chapter 8 : Array Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter9-map-column.html">
   Chapter 9 : Map Column
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter10-struct-column.html">
   Chapter 10 : Struct Column
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter11-json-string-column.html">
   Chapter 11 : JSON Column
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter12-null-nan-column.html">
   Chapter 12 : Null &amp; NaN Column
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter13-user-defined-function.html">
   Chapter 13 : User Defined Functions(UDFs)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter14-pandas-with-arrow.html">
   Chapter 14 : Pandas User Defined Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter15-aggregate-operations.html">
   Chapter 15 : Aggregate Operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter16-join-operations.html">
   Chapter 16 : Join operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter17-window-operations.html">
   Chapter 17 : Window operations
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapters/chapter7-date-column.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ngdeepak/testbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ngdeepak/testbook/issues/new?title=Issue%20on%20page%20%2Fchapters/chapter7-date-column.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/ngdeepak/testbook/edit/master/chapters/chapter7-date-column.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ngdeepak/testbook/master?urlpath=tree/chapters/chapter7-date-column.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-learning-objectives">
   Chapter Learning Objectives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-outline">
   Chapter Outline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-outline-gallery">
   Chapter Outline - Gallery
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-timezone-format-conversions-b">
     <b>
      Timezone format conversions
     </b>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-addition-and-subtraction-on-date-columns-b">
     <b>
      Addition and subtraction on date columns
     </b>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-extract-year-month-date-hour-minute-second-day-weekday-week-quarter-of-year-from-a-datetime-column-b">
     <b>
      Extract year, month, date, hour, minute, second, day, weekday, week/quarter of year from a datetime column
     </b>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-how-to-convert-string-timestamp-to-date-format">
   1a. How to convert string timestamp to date format?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-how-to-convert-a-string-timestamp-to-datetime-format">
   1b. How to convert a string timestamp to datetime format?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#c-how-to-convert-unix-timestamp-to-a-string-timestamp">
   1c. How to convert unix timestamp to a string timestamp?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-how-to-convert-a-timestamp-to-unix-timestamp">
   1d. How to convert a timestamp to unix timestamp?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#e-how-to-convert-timestamp-in-utc-timezone-to-a-given-time-zone">
   1e. How to convert timestamp in UTC timezone to a given time zone?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#f-how-to-convert-from-a-given-time-zone-to-utc-timestamps">
   1f. How to convert from a given time zone to UTC timestamps?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#g-how-to-convert-the-date-format">
   1g. How to convert the date format?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-how-to-find-no-of-days-between-2-dates">
   2a. How to find no of days between 2 dates?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-how-to-find-no-of-months-between-2-dates">
   2b. How to find no of months between 2 dates?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#c-how-to-add-no-of-days-to-a-date">
   2c. How to add no of days to a date?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-how-to-subtract-no-of-days-from-a-date">
   2d. How to subtract no of days from a date?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#e-how-to-add-no-of-months-to-a-date">
   2e. How to add no of months to a date?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-extract-year-month-date-hour-minute-second-day-weekday-week-quarter-of-year-from-a-datetime-column">
   How to extract year, month, date, hour, minute, second, day, weekday, week/quarter of year from a datetime column?
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="figure align-center" id="banner">
<img alt="../_images/banner.png" src="../_images/banner.png" />
</div>
<div class="section" id="chapter-7-date-columns">
<h1>Chapter 7 : Date Columns<a class="headerlink" href="#chapter-7-date-columns" title="Permalink to this headline">¶</a></h1>
<div class="section" id="chapter-learning-objectives">
<h2>Chapter Learning Objectives<a class="headerlink" href="#chapter-learning-objectives" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Various data operations on columns containing date strings, date and timestamps.</p></li>
</ul>
</div>
<div class="section" id="chapter-outline">
<h2>Chapter Outline<a class="headerlink" href="#chapter-outline" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#1">1. How to deal with timezone/format conversions?</a></p>
<ul>
<li><p><a class="reference external" href="#2">1a. How to convert string timestamp to date format?</a></p></li>
<li><p><a class="reference external" href="#3">1b. How to convert  a string timestamp to datetime format?</a></p></li>
<li><p><a class="reference external" href="#4">1c. How to convert a timestamp to unix timestamp?</a></p></li>
<li><p><a class="reference external" href="#5">1d. How to convert unix timestamp to a string timestamp?</a></p></li>
<li><p><a class="reference external" href="#6">1e. How to convert from a given time zone to UTC timestamps?</a></p></li>
<li><p><a class="reference external" href="#7">1f. How to convert timestamp in UTC timezone to a given time zone?</a></p></li>
<li><p><a class="reference external" href="#8">1g. How to convert the date format?</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#9">2. How to add and subtract on date columns?</a></p>
<ul>
<li><p><a class="reference external" href="#10">2a. How to find no of days between 2 dates?</a></p></li>
<li><p><a class="reference external" href="#11">2b. How to find no of months between 2 dates?</a></p></li>
<li><p><a class="reference external" href="#12">2c. How to add no of days to a date?</a></p></li>
<li><p><a class="reference external" href="#13">2d. How to subtract no of days from a date?</a></p></li>
<li><p><a class="reference external" href="#14">2e. How to add no of months to a date?</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#15">3. How to extract year, month, date, hour, minute, second, day, weekday, week/quarter of year from a datetime column?</a></p></li>
</ul>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyspark</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span> \
    <span class="o">.</span><span class="n">builder</span> \
    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;Python Spark SQL basic example&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.some.config.option&quot;</span><span class="p">,</span> <span class="s2">&quot;some-value&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display_html</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">display_side_by_side</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">html_str</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">html_str</span><span class="o">+=</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">html_str</span><span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\xa0\xa0\xa0</span><span class="s2">&quot;</span><span class="o">*</span><span class="mi">10</span>
    <span class="n">display_html</span><span class="p">(</span><span class="n">html_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,</span><span class="s1">&#39;table style=&quot;display:inline&quot;&#39;</span><span class="p">),</span><span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">space</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\xa0</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">panel</span> <span class="k">as</span> <span class="nn">pn</span>

<span class="n">css</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">div.special_table + table, th, td {</span>
<span class="s2">  border: 3px solid orange;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">pn</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">raw_css</span><span class="o">=</span><span class="p">[</span><span class="n">css</span><span class="p">])</span>
<span class="c1">#&lt;div class=&quot;special_table&quot;&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    var skip = [];
    if (window.requirejs) {
      require([], function() {
      })
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) >= 0) { on_load(); continue; }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
	if (!js_urls.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-2.2.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.2.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.2.3.min.js", "https://unpkg.com/@holoviz/panel@^0.10.3/dist/panel.min.js"];
  var css_urls = ["https://unpkg.com/@holoviz/panel@0.10.3/dist/css/alerts.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/card.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/widgets.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/markdown.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/json.css", "https://unpkg.com/@holoviz/panel@0.10.3/dist/css/dataframe.css"];

  var inline_js = [
    function(Bokeh) {
      inject_raw_css("\ndiv.special_table + table, th, td {\n  border: 3px solid orange;\n}\n");
    },
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script></div>
</div>
<p><a id='1'></a></p>
</div>
<div class="section" id="chapter-outline-gallery">
<h2>Chapter Outline - Gallery<a class="headerlink" href="#chapter-outline-gallery" title="Permalink to this headline">¶</a></h2>
<div class="section" id="b-timezone-format-conversions-b">
<h3><b>Timezone format conversions</b><a class="headerlink" href="#b-timezone-format-conversions-b" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>click on</p></th>
<th class="text-align:left head"><p>any image</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#2"><img alt="alt" src="../_images/114.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#3"><img alt="alt" src="../_images/212.png" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><a class="reference external" href="#4"><img alt="alt" src="../_images/311.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#5"><img alt="alt" src="../_images/411.png" /></a></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#6"><img alt="alt" src="../_images/59.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#7"><img alt="alt" src="../_images/68.png" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><a class="reference external" href="#8"><img alt="alt" src="../_images/75.png" /></a></p></td>
<td class="text-align:left"><p></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="b-addition-and-subtraction-on-date-columns-b">
<h3><b> Addition and subtraction on date columns  </b><a class="headerlink" href="#b-addition-and-subtraction-on-date-columns-b" title="Permalink to this headline">¶</a></h3>
<div class="special_table"></div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>click on</p></th>
<th class="text-align:left head"><p>any image</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#10"><img alt="alt" src="../_images/84.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#11"><img alt="alt" src="../_images/93.png" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p><a class="reference external" href="#12"><img alt="alt" src="../_images/102.png" /></a></p></td>
<td class="text-align:left"><p><a class="reference external" href="#13"><img alt="alt" src="../_images/115.png" /></a></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p><a class="reference external" href="#14"><img alt="alt" src="../_images/122.png" /></a></p></td>
<td class="text-align:left"><p></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="b-extract-year-month-date-hour-minute-second-day-weekday-week-quarter-of-year-from-a-datetime-column-b">
<h3><b> Extract year, month, date, hour, minute, second, day, weekday, week/quarter of year from a datetime column  </b><a class="headerlink" href="#b-extract-year-month-date-hour-minute-second-day-weekday-week-quarter-of-year-from-a-datetime-column-b" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="#15"><img alt="alt" src="../_images/132.png" /></a></p>
<p><a id='2'></a></p>
</div>
</div>
<div class="section" id="a-how-to-convert-string-timestamp-to-date-format">
<h2>1a. How to convert string timestamp to date format?<a class="headerlink" href="#a-how-to-convert-string-timestamp-to-date-format" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/114.png" src="../_images/114.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.to_date(col, format=None)</b></p>
<p>Converts a Column into pyspark.sql.types.DateType using the optionally specified format.</p>
<p>Specify formats according to datetime pattern. By default, it follows casting rules to pyspark.sql.types.DateType if the format is omitted.</p>
<p>Equivalent to col.cast(“date”).</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with a column having a string of timestamp</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_str</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;2020-07-15 16:52:44&#39;</span><span class="p">,)],</span> <span class="p">[</span><span class="s1">&#39;string_timestamp&#39;</span><span class="p">])</span>
<span class="n">df_str</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+
|   string_timestamp|
+-------------------+
|2020-07-15 16:52:44|
+-------------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a date column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">to_date</span>
<span class="n">df_date</span> <span class="o">=</span> <span class="n">df_str</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="n">df_str</span><span class="o">.</span><span class="n">string_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">))</span>
<span class="n">df_date</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
|      date|
+----------+
|2020-07-15|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_str</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_date</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>string_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15 16:52:44</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='3'></a></p>
</div>
<div class="section" id="b-how-to-convert-a-string-timestamp-to-datetime-format">
<h2>1b. How to convert a string timestamp to datetime format?<a class="headerlink" href="#b-how-to-convert-a-string-timestamp-to-datetime-format" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/212.png" src="../_images/212.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.to_timestamp(col, format=None)</b></p>
<p>Converts a Column into pyspark.sql.types.TimestampType using the optionally specified format.</p>
<p>Specify formats according to datetime pattern. By default, it follows casting rules to pyspark.sql.types.TimestampType if the format is omitted.</p>
<p>Equivalent to col.cast(“timestamp”).
‘’’</p>
</div>
<p><b>Input:  Spark data frame with a column having a string of timestamp</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_string</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;2020-07-15 16:52:44&#39;</span><span class="p">,)],</span> <span class="p">[</span><span class="s1">&#39;string_timestamp&#39;</span><span class="p">])</span>
<span class="n">df_string</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+
|   string_timestamp|
+-------------------+
|2020-07-15 16:52:44|
+-------------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a timestamp column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">to_timestamp</span>
<span class="n">df_datetime</span> <span class="o">=</span> <span class="n">df_string</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">to_timestamp</span><span class="p">(</span><span class="n">df_string</span><span class="o">.</span><span class="n">string_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">))</span>
<span class="n">df_datetime</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+
|           datetime|
+-------------------+
|2020-07-15 16:52:44|
+-------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_string</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_datetime</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>string_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15 16:52:44</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>datetime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15 16:52:44</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='4'></a></p>
<p><a id='4'></a></p>
</div>
<div class="section" id="c-how-to-convert-unix-timestamp-to-a-string-timestamp">
<h2>1c. How to convert unix timestamp to a string timestamp?<a class="headerlink" href="#c-how-to-convert-unix-timestamp-to-a-string-timestamp" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/311.png" src="../_images/311.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.from_unixtime(timestamp, format=’yyyy-MM-dd HH:mm:ss’)</b></p>
<p>Converts the number of seconds from unix epoch (1970-01-01 00:00:00 UTC) to a string representing the timestamp of that moment in the current system time zone in the given format.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with a number column representing unix time </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_unix</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="mi">1594846364</span><span class="p">,)],</span> <span class="p">[</span><span class="s1">&#39;unix_time&#39;</span><span class="p">])</span>
<span class="n">df_unix</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
| unix_time|
+----------+
|1594846364|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a column with a sliced string</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">from_unixtime</span>
<span class="n">df_time</span> <span class="o">=</span> <span class="n">df_unix</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">from_unixtime</span><span class="p">(</span><span class="n">df_unix</span><span class="o">.</span><span class="n">unix_time</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;timestamp_string&quot;</span><span class="p">))</span>
<span class="n">df_time</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+
|timestamp_string   |
+-------------------+
|2020-07-15 16:52:44|
+-------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_unix</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_time</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>unix_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1594846364</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>timestamp_string</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15 16:52:44</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='5'></a></p>
</div>
<div class="section" id="d-how-to-convert-a-timestamp-to-unix-timestamp">
<h2>1d. How to convert a timestamp to unix timestamp?<a class="headerlink" href="#d-how-to-convert-a-timestamp-to-unix-timestamp" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/411.png" src="../_images/411.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.unix_timestamp(timestamp=None, format=’yyyy-MM-dd HH:mm:ss’)</b></p>
<p>Convert time string with given pattern (‘yyyy-MM-dd HH:mm:ss’, by default) to Unix time stamp (in seconds), using the default timezone and the default locale, return null if fail.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame consisting of a timestamp column in UTC </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">current_timestamp</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(),],)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">current_timestamp</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------+
|timestamp              |
+-----------------------+
|2021-03-06 14:32:43.114|
+-----------------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame consisting of a unix timestamp column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">unix_timestamp</span>
<span class="n">df_unix</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;unixtimestamp&quot;</span><span class="p">))</span>
<span class="n">df_unix</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------+
|unixtimestamp|
+-------------+
|1615059163   |
+-------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_unix</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2021-03-06 14:32:43.710</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>unixtimestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1615059163</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='6'></a></p>
</div>
<div class="section" id="e-how-to-convert-timestamp-in-utc-timezone-to-a-given-time-zone">
<h2>1e. How to convert timestamp in UTC timezone to a given time zone?<a class="headerlink" href="#e-how-to-convert-timestamp-in-utc-timezone-to-a-given-time-zone" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/59.png" src="../_images/59.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.from_utc_timestamp(timestamp, tz)</b></p>
<p>This is a common function for databases supporting TIMESTAMP WITHOUT TIMEZONE. This function takes a timestamp which is timezone-agnostic, and interprets it as a timestamp in UTC, and renders that timestamp as a timestamp in the given time zone.</p>
<p>However, timestamp in Spark represents number of microseconds from the Unix epoch, which is not timezone-agnostic. So in Spark this function just shift the timestamp value from UTC timezone to the given timezone.</p>
<p>This function may return confusing result if the input is a string with timezone, e.g. ‘2018-03-13T06:18:23+00:00’. The reason is that, Spark firstly cast the string to timestamp according to the timezone in the string, and finally display the result by converting the timestamp to string according to the session local timezone.</p>
<p>Parameters</p>
<ul class="simple">
<li><p>timestamp – the column that contains timestamps</p></li>
<li><p>tz – A string detailing the time zone ID that the input should be adjusted to. It should be in the format of<br />
either region-based zone IDs or zone offsets. Region IDs must have the form ‘area/city’, such as
‘America/Los_Angeles’. Zone offsets must be in the format ‘(+|-)HH:mm’, for example ‘-08:00’ or ‘+01:00’. Also
‘UTC’ and ‘Z’ are supported as aliases of ‘+00:00’. Other short names are not recommended to use because they can
be ambiguous.
‘’’</p></li>
</ul>
</div>
<p><b>Input:  Spark data frame consisting of a timestamp column in UTC time zone </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Please note that below timestamp is in UTC.</span>
<span class="n">df_utc</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(),],)</span>
<span class="n">df_utc</span> <span class="o">=</span> <span class="n">df_utc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">current_timestamp</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;timestamp_UTC&quot;</span><span class="p">))</span>
<span class="n">df_utc</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------+
|timestamp_UTC          |
+-----------------------+
|2021-03-06 14:32:44.067|
+-----------------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame consisting of a timestamp column in different timezone</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">from_utc_timestamp</span>
<span class="n">df_tz</span> <span class="o">=</span> <span class="n">df_utc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">from_utc_timestamp</span><span class="p">(</span><span class="n">df_utc</span><span class="o">.</span><span class="n">timestamp_UTC</span><span class="p">,</span><span class="s1">&#39;UTC-4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;timestamp in local TZ&quot;</span><span class="p">))</span>
<span class="n">df_tz</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------+
|timestamp in local TZ  |
+-----------------------+
|2021-03-06 10:32:44.377|
+-----------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_utc</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_tz</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>timestamp_UTC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2021-03-06 14:32:44.584</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>timestamp in local TZ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2021-03-06 10:32:44.691</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='7'></a></p>
</div>
<div class="section" id="f-how-to-convert-from-a-given-time-zone-to-utc-timestamps">
<h2>1f. How to convert from a given time zone to UTC timestamps?<a class="headerlink" href="#f-how-to-convert-from-a-given-time-zone-to-utc-timestamps" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/68.png" src="../_images/68.png" />
</div>
<p>Lets first understand the syntax</p>
<p>{admonition} Syntax
<b>pyspark.sql.functions.to_utc_timestamp(timestamp, tz)</b></p>
<p>This is a common function for databases supporting TIMESTAMP WITHOUT TIMEZONE. This function takes a timestamp which is timezone-agnostic, and interprets it as a timestamp in the given timezone, and renders that timestamp as a timestamp in UTC.</p>
<p>However, timestamp in Spark represents number of microseconds from the Unix epoch, which is not timezone-agnostic. So in Spark this function just shift the timestamp value from the given timezone to UTC timezone.</p>
<p>This function may return confusing result if the input is a string with timezone, e.g. ‘2018-03-13T06:18:23+00:00’. The reason is that, Spark firstly cast the string to timestamp according to the timezone in the string, and finally display the result by converting the timestamp to string according to the session local timezone.</p>
<p><b>Parameters</b></p>
<ul class="simple">
<li><p>timestamp – the column that contains timestamps</p></li>
<li><p>tz – A string detailing the time zone ID that the input should be adjusted to. It should be in the format of either region-based zone IDs or zone offsets. Region IDs must have the form ‘area/city’, such as ‘America/Los_Angeles’. Zone offsets must be in the format ‘(+|-)HH:mm’, for example ‘-08:00’ or ‘+01:00’. Also ‘UTC’ and ‘Z’ are supported as aliases of ‘+00:00’. Other short names are not recommended to use because they can be ambiguous.</p></li>
</ul>
<p><b>Input:  Spark data frame consisting of a timestamp column in UTC time zone </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Please note that local time zone is EST.</span>
<span class="n">df_est</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(),],)</span>
<span class="n">df_est</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">current_timestamp</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">))</span>
<span class="n">df_est</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------+
|timestamp              |
+-----------------------+
|2021-03-06 14:32:44.837|
+-----------------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame consisting of a timestamp column in different timezone</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">to_utc_timestamp</span>
<span class="n">df_utc</span> <span class="o">=</span> <span class="n">df_est</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">to_utc_timestamp</span><span class="p">(</span><span class="n">df_est</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span><span class="s1">&#39;GMT-4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;timestamp in UTC&quot;</span><span class="p">))</span>
<span class="n">df_utc</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------+
|timestamp in UTC       |
+-----------------------+
|2021-03-06 18:32:45.054|
+-----------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_est</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_utc</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2021-03-06 14:32:45.302</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>timestamp in UTC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2021-03-06 18:32:45.460</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='8'></a></p>
</div>
<div class="section" id="g-how-to-convert-the-date-format">
<h2>1g. How to convert the date format?<a class="headerlink" href="#g-how-to-convert-the-date-format" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/75.png" src="../_images/75.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.date_format(date, format)</b></p>
<p>Converts a date/timestamp/string to a value of string in the format specified by the date format given by the second argument.</p>
<p>A pattern could be for instance dd.MM.yyyy and could return a string like ‘18.03.1993’. All pattern letters of datetime pattern. can be used.</p>
<p><b>Parameters</b>:</p>
<ul class="simple">
<li><p>col : column
‘’’</p></li>
</ul>
</div>
<p><b>Input:  Spark data frame with a string date column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_format1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;2020-07-15&#39;</span><span class="p">,)],</span> <span class="p">[</span><span class="s1">&#39;date_format1&#39;</span><span class="p">])</span>
<span class="n">df_format1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------------+
|date_format1|
+------------+
|  2020-07-15|
+------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a formatted date</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">date_format</span>
<span class="n">df_format2</span> <span class="o">=</span> <span class="n">df_format1</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">date_format</span><span class="p">(</span><span class="s1">&#39;date_format1&#39;</span><span class="p">,</span> <span class="s1">&#39;MM/dd/yyy&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;date_format2&#39;</span><span class="p">))</span>
<span class="n">df_format2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------------+
|date_format2|
+------------+
|  07/15/2020|
+------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_format1</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_format2</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input                      output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date_format1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date_format2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>07/15/2020</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='9'></a></p>
<p><a id='10'></a></p>
</div>
<div class="section" id="a-how-to-find-no-of-days-between-2-dates">
<h2>2a. How to find no of days between 2 dates?<a class="headerlink" href="#a-how-to-find-no-of-days-between-2-dates" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/84.png" src="../_images/84.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.datediff(end, start)</b></p>
<p>Returns the number of days from start to end.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame consisting of  date columns</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_dates</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;2020-07-15&#39;</span><span class="p">,</span><span class="s1">&#39;2020-06-10&#39;</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;date1&#39;</span><span class="p">,</span> <span class="s1">&#39;date2&#39;</span><span class="p">])</span>
<span class="n">df_dates</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+----------+
|     date1|     date2|
+----------+----------+
|2020-07-15|2020-06-10|
+----------+----------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a days diff </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">datediff</span>
<span class="n">df_diff</span> <span class="o">=</span> <span class="n">df_dates</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">datediff</span><span class="p">(</span><span class="n">df_dates</span><span class="o">.</span><span class="n">date1</span><span class="p">,</span><span class="n">df_dates</span><span class="o">.</span><span class="n">date2</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">))</span>
<span class="n">df_diff</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----+
|diff|
+----+
|  35|
+----+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_dates</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_diff</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date1</th>
      <th>date2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15</td>
      <td>2020-06-10</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>35</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='11'></a></p>
</div>
<div class="section" id="b-how-to-find-no-of-months-between-2-dates">
<h2>2b. How to find no of months between 2 dates?<a class="headerlink" href="#b-how-to-find-no-of-months-between-2-dates" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/93.png" src="../_images/93.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.months_between(date1, date2, roundOff=True)</b></p>
<p>Returns number of months between dates date1 and date2. If date1 is later than date2, then the result is positive. If date1 and date2 are on the same day of month, or both are the last day of month, returns an integer (time of day will be ignored). The result is rounded off to 8 digits unless roundOff is set to False.</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with date columns</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_month</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;2020-07-15 11:32:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-01-30&#39;</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;date1&#39;</span><span class="p">,</span> <span class="s1">&#39;date2&#39;</span><span class="p">])</span>
<span class="n">df_month</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+----------+
|              date1|     date2|
+-------------------+----------+
|2020-07-15 11:32:00|2020-01-30|
+-------------------+----------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with months between 2 dates</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">months_between</span>
<span class="n">df_month_diff</span> <span class="o">=</span> <span class="n">df_month</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">months_between</span><span class="p">(</span><span class="n">df_month</span><span class="o">.</span><span class="n">date1</span><span class="p">,</span> <span class="n">df_month</span><span class="o">.</span><span class="n">date2</span><span class="p">))</span>
<span class="n">df_month_diff</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------------------------------+
|months_between(date1, date2, true)|
+----------------------------------+
|                        5.53163082|
+----------------------------------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_month</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_month_diff</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date1</th>
      <th>date2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15 11:32:00</td>
      <td>2020-01-30</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>months_between(date1, date2, true)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5.531631</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='12'></a></p>
</div>
<div class="section" id="c-how-to-add-no-of-days-to-a-date">
<h2>2c. How to add no of days to a date?<a class="headerlink" href="#c-how-to-add-no-of-days-to-a-date" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/102.png" src="../_images/102.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.date_add(start, days)</b></p>
<p>Returns the date that is days days after start
‘’’</p>
</div>
<p><b>Input:  Spark data frame with a string date column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_today</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;2020-07-15&#39;</span><span class="p">,)],</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="n">df_today</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
|      date|
+----------+
|2020-07-15|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a new date</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">date_add</span>
<span class="n">df_tomo</span> <span class="o">=</span> <span class="n">df_today</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">date_add</span><span class="p">(</span><span class="n">df_today</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;next_day&#39;</span><span class="p">))</span>
<span class="n">df_tomo</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
|  next_day|
+----------+
|2020-07-16|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_today</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_tomo</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input                      output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>next_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-16</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='13'></a></p>
</div>
<div class="section" id="d-how-to-subtract-no-of-days-from-a-date">
<h2>2d. How to subtract no of days from a date?<a class="headerlink" href="#d-how-to-subtract-no-of-days-from-a-date" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/115.png" src="../_images/115.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.date_sub(start, days)</b></p>
<p>Returns the date that is days days before start</p>
<p>‘’’</p>
</div>
<p><b>Input:  Spark data frame with a date column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_date</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;2020-07-15&#39;</span><span class="p">,)],</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="n">df_date</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
|      date|
+----------+
|2020-07-15|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame with a date column</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">date_sub</span>
<span class="n">df_sub</span> <span class="o">=</span> <span class="n">df_date</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">date_sub</span><span class="p">(</span><span class="n">df_date</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;yesterday&#39;</span><span class="p">))</span>
<span class="n">df_sub</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
| yesterday|
+----------+
|2020-07-14|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df_date</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df_sub</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>yesterday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-14</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='14'></a></p>
</div>
<div class="section" id="e-how-to-add-no-of-months-to-a-date">
<h2>2e. How to add no of months to a date?<a class="headerlink" href="#e-how-to-add-no-of-months-to-a-date" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/122.png" src="../_images/122.png" />
</div>
<p>Lets first understand the syntax</p>
<div class="admonition-syntax admonition">
<p class="admonition-title">Syntax</p>
<p><b>pyspark.sql.functions.add_months(start, months)[source]</b></p>
<p>Returns the date that is months months after start
‘’’</p>
</div>
<p><b>Input:  Spark data frame consisting of a date column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(</span><span class="s1">&#39;2020-07-15&#39;</span><span class="p">,)],</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
|      date|
+----------+
|2020-07-15|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame consisting of a date column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">add_months</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">add_months</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;next_month&#39;</span><span class="p">))</span>
<span class="n">df1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+
|next_month|
+----------+
|2020-08-15|
+----------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                     &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df1</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                      Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-07-15</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>next_month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2020-08-15</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
<p><a id='15'></a></p>
</div>
<div class="section" id="how-to-extract-year-month-date-hour-minute-second-day-weekday-week-quarter-of-year-from-a-datetime-column">
<h2>How to extract year, month, date, hour, minute, second, day, weekday, week/quarter of year from a datetime column?<a class="headerlink" href="#how-to-extract-year-month-date-hour-minute-second-day-weekday-week-quarter-of-year-from-a-datetime-column" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../_images/132.png" src="../_images/132.png" />
</div>
<p><b>Input:  Spark data frame consisting of a datetime column </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([(),],)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">current_timestamp</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------+
|timestamp              |
+-----------------------+
|2021-03-06 14:32:49.705|
+-----------------------+
</pre></div>
</div>
</div>
</div>
<p><b>Output :  Spark data frame consisting of many columns </b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">dayofmonth</span><span class="p">,</span> <span class="n">dayofweek</span><span class="p">,</span> <span class="n">dayofyear</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">minute</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">weekofyear</span><span class="p">,</span> <span class="n">quarter</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span><span class="n">year</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">),</span> 
<span class="n">month</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;month&quot;</span><span class="p">),</span> <span class="n">dayofmonth</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;dayofmonth&quot;</span><span class="p">),</span> 
<span class="n">dayofweek</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;dayofweek&quot;</span><span class="p">),</span> <span class="n">dayofyear</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">),</span> 
<span class="n">hour</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;hour&quot;</span><span class="p">),</span> <span class="n">minute</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;minute&quot;</span><span class="p">),</span> 
<span class="n">second</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;second&quot;</span><span class="p">),</span> <span class="n">weekofyear</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;weekofyear&quot;</span><span class="p">),</span> 
<span class="n">quarter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;quarter&quot;</span><span class="p">))</span>
<span class="n">df2</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------------------+----+-----+----------+---------+---------+----+------+------+----------+-------+
|timestamp              |year|month|dayofmonth|dayofweek|dayofyear|hour|minute|second|weekofyear|quarter|
+-----------------------+----+-----+----------+---------+---------+----+------+------+----------+-------+
|2021-03-06 14:32:49.953|2021|3    |6         |7        |65       |14  |32    |49    |9         |1      |
+-----------------------+----+-----+----------+---------+---------+----+------+------+----------+-------+
</pre></div>
</div>
</div>
</div>
<p><b> Summary:</b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input                            &quot;</span><span class="p">,</span>            <span class="s2">&quot;Output&quot;</span><span class="p">)</span>
<span class="n">display_side_by_side</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span><span class="n">df2</span><span class="o">.</span><span class="n">toPandas</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input                             Output
</pre></div>
</div>
<div class="output text_html"><table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2021-03-06 14:32:50.157</td>
    </tr>
  </tbody>
</table style="display:inline">                              <table style="display:inline" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>timestamp</th>
      <th>year</th>
      <th>month</th>
      <th>dayofmonth</th>
      <th>dayofweek</th>
      <th>dayofyear</th>
      <th>hour</th>
      <th>minute</th>
      <th>second</th>
      <th>weekofyear</th>
      <th>quarter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2021-03-06 14:32:50.251</td>
      <td>2021</td>
      <td>3</td>
      <td>6</td>
      <td>7</td>
      <td>65</td>
      <td>14</td>
      <td>32</td>
      <td>50</td>
      <td>9</td>
      <td>1</td>
    </tr>
  </tbody>
</table style="display:inline">                              </div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ngdeepak/testbook",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="chapter6-number-column.html" title="previous page">Chapter 6 : Number Columns</a>
    <a class='right-next' id="next-link" href="chapter8-array-column.html" title="next page">Chapter 8 : Array Columns</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Deepak Gowda<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>